<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Stanによる分布の近似</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="site_style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">JSSP2018夏のチュートリアル</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">ホーム</a>
</li>
<li>
  <a href="jssp01.html">Lesson1</a>
</li>
<li>
  <a href="jssp02.html">Lesson2</a>
</li>
<li>
  <a href="jssp03.html">Lesson3</a>
</li>
<li>
  <a href="jssp04.html">Lesson4</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Stanによる分布の近似</h1>

</div>


<div id="stan" class="section level1">
<h1>Stanによる乱数の近似；パラメータリカバリを通じて</h1>
<div class="section level3">
<h3>乱数のタネを設定</h3>
<pre class="r"><code>set.seed(201808)</code></pre>
</div>
<div class="section level3">
<h3>データを作ってみます</h3>
<p>これが今回の真値です。データを平均59，標準偏差9の正規分布から作っています。</p>
<pre class="r"><code>Y &lt;- round(rnorm(49, 53, 9))</code></pre>
</div>
<div class="section level3">
<h3>仮想データの中身</h3>
<pre class="r"><code>Y</code></pre>
<pre><code>##  [1] 56 44 51 51 53 51 41 67 62 60 40 41 63 39 54 57 65 61 44 66 43 45 55
## [24] 52 59 32 52 51 60 53 50 50 49 52 55 64 49 60 58 46 50 61 56 50 52 65
## [47] 62 60 45</code></pre>
</div>
<div class="section level3">
<h3>仮想データの平均値</h3>
<pre class="r"><code>mean(Y)</code></pre>
<pre><code>## [1] 53.10204</code></pre>
<p>理論的真値は53ですが，確率変数の実現値は揺れるので53ジャストになることはありませんね。</p>
<p>我々はこのようなデータしか手に入らない中で，平均値はどこにあるのかを探ることになります。</p>
</div>
<div id="stan" class="section level3">
<h3>stanモデルコンパイル</h3>
<p>ここでR から Stanへ，「乱数発生器を作れ」との命令が行きます。 命令を受けたStanはコンパイルを始めます。少し時間がかかるのでお待ちください。</p>
<p>コンパイルが終わっても特に返事はして来ませんが，コンソール画面が「待ち」の状態になれば終わったと思ってください。</p>
<p>警告がたくさん出たとしても，それはコンパイル時の非常にテクニカルな指摘なので気にしなくて結構です。</p>
<pre class="r"><code>model1 &lt;- stan_model(&quot;yoshinaya.stan&quot;)</code></pre>
<pre><code>## data{
##   int&lt;lower=1&gt; N;
##   real X[N];
## }
## 
## parameters{
##   real mu;
## }
## 
## model{
##   X ~ normal(mu,9);
##   mu ~ uniform(0,100);
## }</code></pre>
</div>
<div id="stan" class="section level3">
<h3>stanに与えるデータセットを準備</h3>
<pre class="r"><code>dataset &lt;- list(N=49, X=Y)</code></pre>
</div>
<div id="stan" class="section level3">
<h3>stanをつかってサンプリング</h3>
<pre class="r"><code>fit &lt;- sampling(model1,dataset)</code></pre>
</div>
<div class="section level3">
<h3>結果の出力</h3>
<pre class="r"><code>print(fit)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
## mu    53.11    0.03 1.27  50.62  52.25  53.12  53.98  55.65  1658    1
## lp__ -19.53    0.02 0.69 -21.57 -19.68 -19.27 -19.09 -19.04  1774    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:22 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<p>今回は真値として53の世界からデータが得られていると考えて，モデルを作り，推定値として53.11です。50% confidential inter</p>
</div>
<div class="section level3">
<h3>結果の図示</h3>
<pre class="r"><code>plot(fit,pars=&quot;mu&quot;,show_density=T)</code></pre>
<pre><code>## ci_level: 0.8 (80% intervals)</code></pre>
<pre><code>## outer_level: 0.95 (95% intervals)</code></pre>
<p><img src="jssp02_files/figure-html/visualize2-1.png" width="672" /></p>
</div>
<div class="section level3">
<h3>パッケージを使って美しく描きましょう</h3>
<pre class="r"><code>bayesplot::mcmc_dens(as.array(fit),pars=&quot;mu&quot;)</code></pre>
<p><img src="jssp02_files/figure-html/visualize%20using%20packages-1.png" width="672" /></p>
<pre class="r"><code>bayesplot::mcmc_trace(as.array(fit),pars=&quot;mu&quot;)</code></pre>
<p><img src="jssp02_files/figure-html/visualize%20using%20packages-2.png" width="672" /></p>
<pre class="r"><code>bayesplot::mcmc_areas(as.array(fit,pars=&quot;mu&quot;))</code></pre>
<p><img src="jssp02_files/figure-html/visualize%20using%20packages-3.png" width="672" /></p>
</div>
<div id="mcmc" class="section level3">
<h3>MCMCサンプルを取り出す</h3>
<pre class="r"><code>rstan::extract(fit,pars=&quot;mu&quot;)</code></pre>
<pre><code>## $mu
##    [1] 53.37823 51.95710 53.10912 51.72246 54.59151 55.22467 53.46285
##    [8] 53.94527 53.47290 54.29039 53.16977 54.55334 54.12066 53.55942
##   [15] 53.19326 52.74955 54.63458 54.04044 53.63792 53.36775 52.54010
##   [22] 53.94573 55.96138 53.23312 52.43547 50.17923 53.06059 51.80982
##   [29] 54.33899 54.18850 53.01163 51.71119 53.55639 53.09560 52.16047
##   [36] 54.11409 52.98261 53.05893 53.71960 52.16102 54.23724 51.86729
##   [43] 53.39685 52.99326 55.98341 53.69694 54.47851 51.99801 54.07097
##   [50] 52.64310 53.37110 53.81644 51.42708 52.13756 51.12993 55.39824
##   [57] 52.90906 53.09361 53.25841 52.61359 51.92577 52.10531 53.10339
##   [64] 54.18647 51.66488 52.18207 53.43466 52.23221 53.40900 55.80126
##   [71] 50.93551 53.43118 53.56095 51.63025 52.84745 51.53332 52.76811
##   [78] 53.58318 52.52244 51.53852 52.73868 52.95376 53.32022 53.35656
##   [85] 53.44350 54.40547 53.10580 53.57329 53.91796 53.00454 51.84370
##   [92] 53.77054 51.50140 52.13422 51.95646 54.69232 52.43724 53.84714
##   [99] 51.84895 52.44956 51.35405 54.62484 52.95950 52.19955 51.39878
##  [106] 53.54721 53.54077 50.61932 55.57375 54.09157 52.23904 54.29910
##  [113] 54.94247 56.06447 54.39428 51.46058 53.19926 54.10675 56.21343
##  [120] 55.28575 51.40966 53.97157 51.97621 52.45640 52.06629 53.31235
##  [127] 53.30961 53.64197 52.63162 52.76084 50.85300 52.66186 54.33473
##  [134] 52.16863 50.93853 52.65393 53.92626 49.72677 52.95501 51.73854
##  [141] 53.35098 53.24084 53.33013 51.91600 52.84359 53.83981 54.03598
##  [148] 51.28616 53.37257 50.41291 52.83406 52.26882 53.26246 54.47294
##  [155] 53.37021 52.90289 55.68353 52.34907 53.77279 51.73282 51.07078
##  [162] 52.84339 50.88620 52.57448 54.70170 52.38177 52.30672 54.51340
##  [169] 54.16290 53.36660 53.29414 51.94569 54.18564 55.56806 54.64190
##  [176] 53.93903 52.85427 53.20375 52.66803 52.48996 54.17357 53.27103
##  [183] 51.09947 52.42344 53.93204 52.98462 53.43118 53.11537 54.16109
##  [190] 53.83745 53.11159 54.76820 53.27432 53.98184 52.95148 53.58328
##  [197] 54.08371 51.58689 51.73137 52.47745 52.94600 51.58380 51.79664
##  [204] 54.98498 53.03152 53.27432 52.00901 54.80846 53.64866 53.08218
##  [211] 53.60040 55.00136 51.41763 53.65222 53.16924 54.95847 50.81482
##  [218] 52.76394 53.81879 53.00357 53.69437 54.72667 53.24908 52.68871
##  [225] 51.38709 52.31372 52.65579 53.88004 54.54469 54.75237 53.71744
##  [232] 52.49191 54.44470 53.61042 52.72884 54.80977 51.30924 51.67114
##  [239] 54.47851 52.65520 52.68470 53.40539 52.58582 52.83838 52.10242
##  [246] 55.15170 53.44665 53.15907 52.28029 52.90206 53.72641 54.44913
##  [253] 52.16776 55.55813 53.86970 52.82219 52.10468 51.36814 49.81430
##  [260] 52.98675 52.38291 53.30315 52.74021 52.29634 52.35396 53.81916
##  [267] 53.15433 52.78564 51.53453 54.16109 52.26730 52.28911 53.62911
##  [274] 53.66821 52.83732 52.90982 53.08876 53.82057 52.66267 51.46017
##  [281] 50.17824 54.27357 54.33388 53.80258 54.71004 51.95567 53.38641
##  [288] 52.43409 54.49119 52.37513 54.51388 50.74375 51.02358 55.94868
##  [295] 53.03859 55.91401 50.81703 51.16187 52.47471 53.88023 50.68733
##  [302] 54.00385 55.35608 53.46825 53.32484 50.29907 53.47902 52.56347
##  [309] 54.94349 50.66158 52.71429 53.55850 53.27464 54.63163 52.35721
##  [316] 54.05201 51.19120 52.09167 51.43857 53.89929 53.40564 53.35342
##  [323] 54.51343 51.65203 54.21680 52.06871 52.20179 53.46643 52.55057
##  [330] 53.34715 55.24965 53.97074 53.38825 54.17227 55.08140 53.22087
##  [337] 51.92891 54.61928 52.77594 53.14367 53.16485 54.29039 52.65224
##  [344] 54.55843 53.14188 54.94349 53.49634 50.16022 54.46874 52.44994
##  [351] 52.20536 53.62581 52.78451 52.05524 53.76832 53.75250 52.86333
##  [358] 51.71119 53.26622 54.80001 54.35181 53.00627 52.90759 52.63351
##  [365] 51.89873 51.81375 53.93016 53.41467 52.29234 53.68515 52.84680
##  [372] 53.36396 55.21740 53.14866 53.93675 52.59494 55.28646 52.22592
##  [379] 52.62478 52.72980 51.77993 53.57220 52.73200 54.09463 53.76661
##  [386] 51.79025 53.48463 53.72351 55.62361 51.73854 52.05712 52.88645
##  [393] 53.27530 53.47297 51.56686 52.43055 51.28335 53.96878 51.78592
##  [400] 53.59819 51.69962 53.67404 51.98009 51.68825 52.39068 52.57878
##  [407] 53.78353 52.72666 52.00913 53.01303 55.79073 52.21672 54.69705
##  [414] 51.62450 54.61498 53.55787 53.36483 54.80846 51.15658 52.39370
##  [421] 52.33013 53.18230 55.14148 54.88694 52.22839 50.74651 53.39130
##  [428] 52.20997 53.50677 53.03981 55.65342 54.61642 53.10913 51.58638
##  [435] 53.41234 54.11950 51.74899 51.53911 54.12129 53.92626 50.61382
##  [442] 53.89929 53.11970 51.39496 53.48933 52.01010 51.43405 53.00470
##  [449] 52.80616 52.17270 53.01233 52.26204 53.08610 53.14765 51.21758
##  [456] 53.25392 53.21291 52.82650 53.92403 52.25171 51.47316 52.77190
##  [463] 52.88876 52.19384 53.23804 53.28015 52.22190 54.80977 51.17883
##  [470] 53.24728 53.25423 51.70257 54.48681 53.18230 54.00752 51.89707
##  [477] 54.60500 51.31762 50.57546 55.32553 50.81335 53.12005 53.30357
##  [484] 54.69535 51.42708 52.66755 53.05301 51.58681 53.80849 51.81902
##  [491] 53.41939 53.65701 56.66383 53.19213 53.33907 50.62737 53.16738
##  [498] 53.57354 53.80849 54.59188 54.01881 52.97501 52.70275 52.95327
##  [505] 53.93650 51.60049 53.61436 52.45856 54.57568 52.68471 52.47443
##  [512] 51.68819 51.99463 55.28033 53.95083 54.13102 53.55251 51.51374
##  [519] 53.81632 55.98497 53.40593 53.68984 51.40143 53.51640 52.77413
##  [526] 53.27811 54.44410 52.16410 53.34715 53.23106 51.69074 53.54514
##  [533] 53.36114 54.45294 52.49212 53.39974 54.60245 54.86629 52.90130
##  [540] 52.58152 51.87261 52.55881 53.27172 53.01720 53.91806 53.48036
##  [547] 52.05749 52.26511 51.74190 54.48915 50.17846 55.15224 50.19258
##  [554] 53.49045 52.88876 52.23780 55.13720 53.21104 51.82454 53.23147
##  [561] 50.63956 51.32558 54.17689 53.85640 53.18409 53.63109 53.20168
##  [568] 54.28306 54.98503 52.53508 54.23360 53.17650 52.72006 53.92830
##  [575] 53.26822 53.42881 52.89037 54.75491 51.69732 54.61642 53.49758
##  [582] 52.36381 54.39633 50.43488 51.76756 52.89635 52.88762 53.08218
##  [589] 54.36397 51.47805 54.99832 52.84980 53.42887 53.67295 52.73940
##  [596] 52.71160 52.41884 53.35624 52.59494 55.80165 53.20098 54.55257
##  [603] 54.87740 52.45202 51.82361 51.99770 53.95599 51.47048 52.50873
##  [610] 55.15668 52.33727 53.04215 53.59678 53.34827 53.61517 51.68559
##  [617] 53.47114 52.22855 55.83798 53.06083 52.95148 53.14188 53.78838
##  [624] 55.29188 53.41467 51.91302 53.18409 52.49212 54.87842 53.93821
##  [631] 53.31045 52.52367 52.73444 52.44665 53.37881 52.82984 52.41512
##  [638] 52.89341 53.34759 52.61826 54.89168 52.80872 51.86963 49.69358
##  [645] 51.56823 53.15238 54.62530 53.23509 51.66679 55.16273 52.40727
##  [652] 53.08866 53.19301 53.53511 53.49479 53.61015 53.39228 53.31820
##  [659] 55.58770 54.69095 52.55220 52.01121 52.63277 51.16042 50.76202
##  [666] 52.52434 52.58863 53.47336 52.07285 51.37407 53.92626 51.19517
##  [673] 55.12167 53.82190 54.38416 53.96810 52.81118 53.80635 54.11941
##  [680] 55.41214 54.66818 53.26702 54.19676 54.77457 54.24978 54.88304
##  [687] 52.24549 53.85306 54.11788 53.96878 55.31856 52.42252 53.56168
##  [694] 51.30595 53.91806 55.44958 53.74101 52.89539 53.19614 53.20098
##  [701] 53.42074 53.28835 54.01699 52.19886 52.88821 51.59894 53.23509
##  [708] 50.41275 53.41168 53.37409 52.65052 51.28616 57.74066 51.39180
##  [715] 52.38130 54.42947 52.74313 50.88715 51.48591 52.77604 53.39723
##  [722] 53.11892 53.09809 52.43409 53.04104 49.98304 54.36218 52.05039
##  [729] 53.15907 51.69174 53.16770 54.87717 52.50286 53.06033 51.61503
##  [736] 52.41817 52.33301 54.90216 53.33392 54.06510 53.11178 55.15387
##  [743] 53.85531 52.36412 53.37881 51.25171 53.16321 55.14436 52.76277
##  [750] 54.85975 54.36130 56.20214 55.45317 52.72744 52.26511 52.71538
##  [757] 52.04041 53.95267 54.62498 53.08279 51.73854 53.04763 53.24918
##  [764] 52.26448 52.16730 52.68370 50.53751 54.16265 53.04599 53.31294
##  [771] 52.41716 52.94625 52.02468 54.54870 54.10144 51.95292 53.19910
##  [778] 54.25674 50.85378 51.61882 53.20846 51.97143 52.74119 54.04393
##  [785] 53.36940 54.52130 54.51924 52.02627 52.37394 53.81558 53.01205
##  [792] 50.69352 52.28306 54.92808 51.02281 54.64474 53.53091 53.84830
##  [799] 51.22831 51.70705 52.54077 53.45703 52.46838 52.83862 55.27737
##  [806] 52.46649 50.28118 53.00402 52.78137 57.24455 54.52653 50.83254
##  [813] 53.47028 53.69898 53.42924 52.94190 53.60994 54.36218 54.93929
##  [820] 53.22599 52.14595 53.02182 54.70828 52.53887 54.76493 54.21124
##  [827] 53.71017 52.69247 53.76202 51.07078 53.09428 51.21897 53.59783
##  [834] 51.74389 54.30010 52.20525 52.17722 54.14101 51.97811 52.02098
##  [841] 53.05992 54.34427 52.58802 53.06847 51.17614 54.10422 52.42511
##  [848] 54.44913 54.82978 55.16082 54.53457 52.57876 53.20823 56.19976
##  [855] 52.59603 52.46349 53.72443 54.67245 55.31880 51.34602 52.47736
##  [862] 52.02938 52.68495 53.20669 52.80554 53.02149 52.93434 51.77867
##  [869] 51.17614 53.46259 52.29697 54.80846 52.23904 52.42302 50.74651
##  [876] 53.95084 49.64270 53.54714 55.02759 52.58399 53.02915 51.87095
##  [883] 54.03423 51.21897 52.51729 54.10422 49.59378 50.48083 53.72280
##  [890] 53.35878 55.95957 53.71325 53.67619 50.80959 53.34376 51.65921
##  [897] 54.49134 52.28360 52.10242 53.79951 54.31129 52.57069 53.70804
##  [904] 54.78846 53.26054 53.27521 52.73149 51.89693 54.18482 49.85265
##  [911] 52.57189 52.56147 52.62841 54.64083 54.62498 53.27392 53.01720
##  [918] 55.63599 52.29316 54.16591 54.86914 51.88534 52.43357 54.26197
##  [925] 51.97621 54.87933 54.29466 52.53122 53.85293 54.42947 52.80554
##  [932] 53.46138 53.22694 53.24689 51.20022 52.27191 56.18560 53.06059
##  [939] 51.41172 53.50736 55.23828 51.43064 53.17636 52.11979 53.17498
##  [946] 54.26021 53.69679 50.96702 53.94755 56.67332 52.82913 51.76312
##  [953] 52.53017 54.57574 52.69606 52.65520 54.41923 52.69120 53.27521
##  [960] 54.86152 53.50680 53.49298 53.53091 52.08452 53.56121 53.80595
##  [967] 53.11202 53.10465 54.03742 52.97114 54.87235 54.01287 53.49419
##  [974] 52.79317 52.57746 53.05098 54.12675 57.10370 53.04215 51.10222
##  [981] 51.44985 52.96438 54.70907 53.49834 53.03990 54.31002 54.93270
##  [988] 54.35397 52.90115 52.99187 55.99040 55.50279 52.84438 53.71565
##  [995] 54.27357 51.78303 52.89899 54.39291 53.11732 52.30292 54.97807
## [1002] 52.39116 54.11382 54.01705 52.74099 55.35381 51.55994 53.08008
## [1009] 53.90090 53.72633 55.74907 52.35198 53.46735 53.13079 53.07562
## [1016] 54.27812 53.58484 53.83694 51.40907 53.60933 51.40485 53.04913
## [1023] 53.72955 54.93729 50.65908 51.66973 53.51126 51.36968 54.12410
## [1030] 54.55012 54.91413 52.47180 53.79317 51.42724 54.95612 55.37410
## [1037] 51.71001 52.54101 52.18460 55.00499 54.76358 55.44864 55.84404
## [1044] 54.48813 54.35735 54.02669 51.30546 54.17223 51.74802 53.77675
## [1051] 52.92196 52.04723 51.39935 52.62744 54.43549 54.48237 49.18271
## [1058] 54.40326 52.81393 53.30863 51.19569 53.46943 51.59237 54.21476
## [1065] 52.77883 53.78569 52.18899 52.85254 52.99007 55.99171 54.41816
## [1072] 51.56411 52.02348 53.16182 53.64897 49.78599 51.77618 54.18084
## [1079] 50.92126 54.28046 52.60203 53.79880 52.96200 51.44616 50.91014
## [1086] 51.99601 53.69586 55.96678 51.93496 54.92628 54.70399 53.43710
## [1093] 53.91081 53.53413 52.09317 52.00069 53.28660 54.22379 52.45517
## [1100] 54.32966 54.24866 53.79311 53.22757 54.11832 54.79774 50.96296
## [1107] 53.23370 53.54670 52.93318 53.41724 52.56994 52.64256 52.98872
## [1114] 55.47675 54.55449 52.01096 56.02761 51.59098 52.04111 54.14470
## [1121] 50.95673 53.66843 53.53941 51.28456 54.08642 53.41328 52.09819
## [1128] 54.05217 53.09577 52.05055 52.59201 55.31039 52.23241 53.60834
## [1135] 52.87596 52.91399 54.48680 55.73476 53.12037 54.95360 51.52632
## [1142] 54.84277 54.56036 52.36983 52.67594 55.02061 53.67434 53.14801
## [1149] 53.49822 52.56911 54.35019 51.83675 56.48951 51.94209 53.12801
## [1156] 53.00640 53.67298 52.71675 52.31982 53.61239 52.33731 52.90567
## [1163] 54.33544 52.17546 50.46998 51.98472 51.97422 52.52653 53.44977
## [1170] 55.75782 52.34401 55.18719 53.55215 55.76944 54.60967 51.17421
## [1177] 54.09549 55.21865 54.32590 52.92822 51.84991 53.85069 55.00695
## [1184] 54.02791 53.88691 52.95634 54.05189 53.04077 51.60394 53.91129
## [1191] 53.52951 51.57419 51.16070 52.68042 52.74059 51.81205 54.33485
## [1198] 52.58602 54.98049 52.96484 54.41785 54.20977 51.80451 53.62332
## [1205] 54.04298 52.95634 54.38828 52.92440 50.93294 54.20887 52.52514
## [1212] 53.25386 52.27211 53.67173 53.63619 54.72914 53.70736 53.61550
## [1219] 54.22489 52.06100 53.21063 53.84841 52.77847 52.19960 52.99414
## [1226] 51.79405 52.10546 53.01332 53.51433 51.03372 54.49535 52.68931
## [1233] 53.51596 55.28693 52.46738 51.69809 51.00524 54.56848 50.99828
## [1240] 55.31994 51.36000 55.29911 53.95631 54.22987 56.12172 52.45448
## [1247] 53.06191 53.74500 52.96570 50.67578 54.80352 52.34846 54.58169
## [1254] 52.51780 52.48757 54.58596 52.81502 49.67024 51.78148 53.97988
## [1261] 52.37234 55.53443 54.10287 54.14865 54.22424 53.49689 53.71440
## [1268] 53.75031 53.45020 53.97220 53.82903 50.23861 55.06905 54.13672
## [1275] 53.87817 53.93988 53.58877 53.39692 51.91192 53.11917 54.59051
## [1282] 51.92132 53.75386 51.93290 52.28042 55.69111 54.37997 52.20221
## [1289] 52.43411 49.48934 52.19764 53.94661 52.82462 54.24508 52.62111
## [1296] 50.79389 53.14089 54.38955 54.05926 52.86770 50.05570 52.21962
## [1303] 53.60408 52.26917 52.68754 55.10100 52.38348 52.62991 51.78123
## [1310] 52.78198 51.21394 55.18098 53.02145 53.53193 53.62650 52.49786
## [1317] 54.65333 53.19351 53.74719 51.84810 53.25444 52.51113 54.17663
## [1324] 53.63951 52.28694 53.17661 52.77689 53.56817 53.00408 55.60339
## [1331] 52.29899 53.32972 53.57359 54.11411 52.05323 53.47959 52.20974
## [1338] 52.74938 55.64385 52.88573 52.85376 52.25097 54.52661 53.43494
## [1345] 53.28145 52.29830 51.33603 55.19051 53.44977 52.65808 53.82713
## [1352] 51.17353 54.31235 54.02494 54.70201 50.77945 53.22932 53.12801
## [1359] 54.54848 52.95383 54.84892 53.21079 54.55482 52.64065 54.09552
## [1366] 54.22395 53.65401 51.64879 52.22568 51.62983 53.53193 53.96546
## [1373] 52.31973 54.55148 51.59702 52.31666 53.21769 55.34846 51.84186
## [1380] 50.75389 55.10047 51.85410 49.68348 52.28317 52.54470 53.01509
## [1387] 55.03975 52.50829 53.68486 54.58492 53.75351 55.04727 54.36885
## [1394] 53.38539 53.20846 53.62439 53.82779 53.88233 51.30677 52.42703
## [1401] 54.57821 52.53066 52.74099 53.41755 53.92229 54.35921 52.09068
## [1408] 52.92481 52.09010 53.74393 51.42835 51.57777 53.05610 53.19570
## [1415] 53.06987 50.08569 53.94117 55.35981 53.99899 53.48573 51.91302
## [1422] 52.57718 54.64298 50.68696 56.16581 53.89765 53.54112 54.24453
## [1429] 52.87645 53.35146 52.96487 52.53192 52.37145 54.42311 52.42110
## [1436] 53.60780 52.00611 53.82357 50.21094 56.00796 53.84486 51.34726
## [1443] 53.56865 52.46577 52.06115 50.79754 53.04603 52.63320 53.98182
## [1450] 52.51483 53.75765 51.18210 56.23849 51.76920 53.31867 54.62538
## [1457] 53.67473 51.96270 52.47261 53.26534 53.31681 52.01449 51.09479
## [1464] 53.69315 52.93552 53.44281 52.30375 53.75498 52.06841 54.30204
## [1471] 51.28499 55.59324 51.53523 50.96221 53.58815 52.30382 51.77725
## [1478] 52.96484 52.90481 55.35910 54.72002 54.41419 54.33753 51.76575
## [1485] 51.83952 55.35834 53.45367 54.03797 55.47230 54.05341 52.42304
## [1492] 52.36410 54.77204 53.79148 54.21615 51.60313 54.08735 55.04457
## [1499] 53.97349 54.21068 52.70373 55.51460 52.57314 54.12355 51.89446
## [1506] 54.00846 55.13245 51.03708 54.05501 52.64476 52.51117 54.60864
## [1513] 55.49448 52.51390 54.23586 52.92672 49.93053 50.82289 54.13976
## [1520] 52.53052 53.88277 53.32059 51.69156 52.15122 52.09002 51.58856
## [1527] 50.79448 52.67451 53.62956 55.04388 52.39969 54.29025 53.03733
## [1534] 53.53846 56.27863 54.43077 53.57854 51.76134 51.05078 53.78855
## [1541] 53.33573 54.12363 52.67248 51.48330 53.91073 53.13988 52.60288
## [1548] 51.97567 52.45517 54.48865 53.14563 53.55644 53.39289 52.27749
## [1555] 50.56672 53.69399 51.96119 54.70170 52.73797 54.35735 52.96919
## [1562] 53.33230 52.88046 51.05880 53.13001 52.72464 52.89509 51.92991
## [1569] 52.06714 49.97230 53.45009 51.24250 51.87486 54.19225 52.68109
## [1576] 53.73109 54.36506 51.40313 52.37611 53.62594 52.67912 53.49822
## [1583] 51.70013 52.77451 53.82357 52.31507 52.79391 52.21087 54.23862
## [1590] 51.96822 53.60555 53.03389 54.60967 55.15442 52.18689 54.55771
## [1597] 54.88755 55.11940 52.74235 52.36381 53.48787 53.50158 50.93058
## [1604] 53.73828 52.42050 54.04116 53.13579 53.85136 52.79152 52.91379
## [1611] 56.26931 54.41807 51.84390 53.79302 52.16199 53.82978 55.63703
## [1618] 53.55288 54.11412 51.67815 52.79370 54.07692 51.57351 52.21883
## [1625] 52.49427 51.94819 51.36484 52.19534 51.70120 52.53726 51.96644
## [1632] 53.17841 52.62174 53.36187 54.50530 52.98958 54.48680 53.29832
## [1639] 53.38052 53.00029 51.67049 52.89324 52.24162 53.65011 55.71867
## [1646] 50.92748 55.15165 53.89397 51.87710 55.54406 53.33914 53.08462
## [1653] 54.09628 53.19370 53.96909 50.86395 54.13028 52.92884 53.21153
## [1660] 53.79834 52.04730 54.99530 51.59139 55.34205 54.61331 53.52295
## [1667] 54.17389 51.59830 53.30471 53.14937 52.68428 52.21605 55.20139
## [1674] 51.97090 52.08243 55.65624 52.26785 50.40839 53.29117 52.82161
## [1681] 51.83659 52.72396 51.49585 54.87241 54.78330 53.36627 52.48531
## [1688] 52.86841 54.60585 56.04998 51.57204 53.96758 54.06321 55.35834
## [1695] 54.61064 56.55602 52.86598 53.75200 53.03298 54.73116 51.07841
## [1702] 56.92416 53.96034 51.86560 52.61488 54.10457 53.09197 51.98202
## [1709] 55.83422 53.74769 52.66508 52.64853 54.08714 51.47340 53.63961
## [1716] 52.44854 55.08081 52.45737 52.86087 53.48037 52.40300 53.08797
## [1723] 54.19493 52.99885 51.25650 51.52755 50.84669 53.91135 51.96348
## [1730] 51.30208 53.75080 51.02574 53.20768 52.86235 52.41823 51.68638
## [1737] 52.94355 52.78737 52.57145 54.21196 53.01332 51.78943 52.84857
## [1744] 52.46405 52.74871 55.38706 49.89146 52.39441 53.74963 54.23256
## [1751] 53.16280 54.04842 52.80259 54.65333 53.35864 50.52432 52.17242
## [1758] 54.04074 52.26494 51.45362 54.80674 53.40052 52.53699 52.67690
## [1765] 53.02700 51.97453 53.65509 51.36000 53.78768 52.52019 52.64581
## [1772] 54.28399 53.79047 52.51848 54.30204 53.06755 53.91081 53.13579
## [1779] 51.98822 52.38258 51.02288 54.61290 53.90357 55.16070 54.08925
## [1786] 53.67418 53.13914 54.93715 53.15539 54.25925 51.89039 53.42206
## [1793] 51.84974 52.76963 51.97567 53.54466 52.26330 52.65886 54.57151
## [1800] 52.40674 53.10560 51.84753 53.11971 52.44373 53.02593 53.19523
## [1807] 53.85069 52.40486 51.15598 52.59162 53.78428 54.42105 53.37105
## [1814] 51.62016 52.98855 51.06436 52.29799 54.27936 54.08759 52.55446
## [1821] 51.95030 52.40697 52.49211 51.01812 53.15743 51.35432 53.56897
## [1828] 53.58477 54.35492 50.23375 52.69975 53.24896 52.60886 52.01648
## [1835] 53.20851 52.05053 50.43446 52.91299 53.54322 54.50307 50.14589
## [1842] 52.84120 54.60801 53.40588 54.60102 52.64449 53.75464 51.85539
## [1849] 53.91692 52.73913 54.22395 54.58098 52.72464 52.92433 51.47029
## [1856] 50.83232 53.79041 52.79114 53.61976 52.80846 54.67931 53.70955
## [1863] 52.02697 53.51188 56.00198 55.81444 50.97603 54.39971 52.15317
## [1870] 52.27076 52.77830 52.58255 52.34629 51.18790 53.28877 53.53696
## [1877] 53.36647 52.09773 52.08693 52.64244 52.14139 53.17526 52.53252
## [1884] 51.78535 54.88726 53.73184 53.89110 52.23136 52.65058 52.55446
## [1891] 52.51874 52.82173 53.16619 54.52468 54.35878 54.06429 51.96629
## [1898] 52.04111 52.56216 51.08832 53.41856 53.84944 51.93439 54.22555
## [1905] 53.66561 53.62699 54.58188 52.10247 51.54368 54.59419 50.94963
## [1912] 52.42572 54.13964 52.12966 56.24048 54.73753 54.56036 53.18870
## [1919] 52.73769 53.35009 55.28506 51.96450 56.25541 52.57588 52.97026
## [1926] 52.18242 52.90829 51.65173 53.33977 52.93135 51.30414 53.04354
## [1933] 53.56524 54.04710 54.31684 53.58687 53.55552 54.13045 52.58090
## [1940] 52.49023 54.15771 55.53964 54.00554 52.76920 54.97478 53.84600
## [1947] 54.33580 55.61816 52.49162 52.57885 52.80240 54.45306 50.41316
## [1954] 51.80451 52.05494 53.13339 51.17807 53.63672 50.29198 52.75544
## [1961] 54.14518 53.71593 53.52331 53.34765 53.27617 53.03389 52.16733
## [1968] 53.51493 53.35045 53.66154 52.98298 50.99222 54.84029 52.33604
## [1975] 53.14852 54.05501 52.85617 52.14219 53.08268 52.99250 53.94170
## [1982] 51.88441 52.55822 53.03521 53.35624 54.77905 52.66437 54.42493
## [1989] 52.82857 54.38195 51.10522 54.11443 53.04007 51.94824 53.69166
## [1996] 52.39489 51.54273 53.23024 53.38935 52.89890 55.35166 52.58767
## [2003] 50.53976 52.35598 52.63294 54.70194 52.80294 54.80865 51.32377
## [2010] 53.34845 52.51380 54.56503 52.30305 55.07323 54.37730 52.21539
## [2017] 53.71200 51.23507 53.49925 53.60898 53.48182 50.90202 54.06499
## [2024] 52.17502 52.85756 55.68884 53.26311 50.33657 53.98863 51.59190
## [2031] 51.10781 55.13039 52.31312 54.74836 54.02820 53.17664 52.86010
## [2038] 53.50443 54.04183 53.00714 51.90816 52.95715 53.95204 53.01765
## [2045] 53.02846 52.40406 52.14129 51.97716 55.27939 54.20831 53.09739
## [2052] 54.90535 55.59270 54.16587 55.13039 53.48504 54.34819 53.46961
## [2059] 54.94229 52.90797 51.67551 53.89706 54.65425 53.32943 54.96328
## [2066] 53.14795 54.01394 52.39624 50.55787 54.15328 54.42806 52.80279
## [2073] 54.91607 51.59272 54.43052 52.04632 53.56150 54.48108 52.98086
## [2080] 54.28438 52.62878 55.33600 52.16236 53.44700 51.15056 52.27259
## [2087] 51.77285 50.41951 55.42254 53.81544 51.15254 55.43817 53.41086
## [2094] 51.74492 53.87031 52.84516 52.42913 55.26999 54.22618 52.83317
## [2101] 51.78275 53.36898 54.29256 51.66916 53.34353 52.55662 50.01154
## [2108] 51.73893 53.91610 52.66287 53.26744 52.88097 52.36440 52.16540
## [2115] 53.44858 53.95488 52.72880 52.80854 54.20309 54.45272 53.39667
## [2122] 52.21720 53.22861 55.07583 52.90519 53.61076 52.33442 50.76118
## [2129] 54.71995 53.97850 52.67641 51.47317 51.29426 53.35066 51.75552
## [2136] 51.70078 53.13811 54.76295 53.22122 53.14980 53.53457 50.45050
## [2143] 52.67100 53.83771 52.76312 50.48329 53.04233 52.77456 56.14233
## [2150] 51.45874 53.34586 53.57427 52.31631 52.60349 54.00300 54.42435
## [2157] 52.51430 54.79489 53.72769 50.60620 54.87824 54.42931 54.95126
## [2164] 52.23076 52.95177 55.33434 52.65198 54.04789 54.99640 53.25998
## [2171] 53.73888 51.87179 54.22688 53.29599 54.95543 53.33974 54.84494
## [2178] 52.40029 52.33879 52.34294 51.30618 52.80279 52.91705 53.81034
## [2185] 55.07323 51.48170 55.38152 51.52449 51.58840 54.63346 51.43358
## [2192] 52.46676 54.11018 51.09746 53.55783 51.36235 52.90022 50.94182
## [2199] 52.25058 56.30123 53.19606 52.88754 53.66635 53.90446 52.60096
## [2206] 50.92221 54.43103 52.99621 50.68151 53.50746 54.13452 53.28315
## [2213] 50.95440 54.46836 51.59301 53.68100 49.99924 54.16505 51.52979
## [2220] 53.87815 52.72275 52.75972 54.28028 53.51316 51.42257 53.40946
## [2227] 53.28221 54.33402 52.75976 52.17502 54.82270 53.28138 52.27699
## [2234] 55.37618 52.04842 52.66476 52.35580 51.78275 52.80416 52.04000
## [2241] 54.04972 53.43472 53.50816 54.75061 53.04387 52.40712 50.69241
## [2248] 53.53184 54.04789 55.09325 51.36706 51.59198 53.25045 54.41536
## [2255] 53.25516 51.92863 54.44132 52.36378 52.64930 54.20288 50.67816
## [2262] 52.16468 52.47987 54.05443 51.45197 50.24497 53.58844 53.54002
## [2269] 53.24686 50.65974 51.25182 54.74088 51.86088 49.99627 51.69347
## [2276] 55.16140 53.29839 54.75885 50.76851 54.92437 51.06793 51.89909
## [2283] 53.22183 54.07886 51.01321 51.71159 52.96381 54.38058 52.57919
## [2290] 50.98508 53.72925 52.46243 54.13958 51.13468 51.98152 49.46259
## [2297] 54.70109 53.62139 52.10879 51.42306 55.59433 54.61643 53.53457
## [2304] 53.29308 54.67091 53.23006 54.02745 53.24461 51.96345 51.02760
## [2311] 52.10879 52.53033 53.27142 52.83279 53.56512 50.83892 54.01266
## [2318] 52.09469 54.59880 51.85750 53.33148 54.16862 52.19559 52.93324
## [2325] 52.04247 53.75656 52.35770 51.88473 53.84114 52.01403 54.94767
## [2332] 55.31036 51.65504 51.79964 53.98646 52.00248 53.56794 52.21720
## [2339] 51.91679 52.74103 52.35770 56.78305 52.89481 52.30086 52.81216
## [2346] 52.21127 53.07090 52.28199 54.02595 52.22883 54.45723 53.19241
## [2353] 51.55465 51.15503 51.14065 53.25269 51.40919 51.57838 53.69359
## [2360] 52.68553 53.26882 53.19598 54.96417 53.62543 53.56454 54.58269
## [2367] 54.94767 52.34063 53.69939 56.06825 52.16875 54.54458 49.99635
## [2374] 54.08190 54.27270 53.45871 51.56479 52.97773 53.17259 52.75899
## [2381] 53.03935 54.23020 53.35533 52.57154 53.20461 53.59986 54.20178
## [2388] 56.44390 52.53194 53.11124 54.29632 54.07886 53.12537 54.31780
## [2395] 53.74360 50.67647 52.79287 53.24167 53.25101 55.04247 55.32364
## [2402] 51.97227 53.41913 54.24295 51.44396 52.82499 53.89963 51.45484
## [2409] 52.64285 52.59744 52.72357 52.82910 52.16024 55.91000 51.78064
## [2416] 52.98602 51.26777 51.60371 51.92712 52.24457 54.01888 55.14052
## [2423] 53.14621 52.72604 53.03464 52.91322 53.92236 50.98508 51.77498
## [2430] 54.10481 51.94075 52.64085 53.48658 53.11963 53.28180 51.78554
## [2437] 52.18743 51.87685 53.47173 53.47059 52.15399 54.30057 53.18918
## [2444] 53.30440 50.12030 52.88815 52.36499 52.29049 53.64142 53.96114
## [2451] 55.32880 55.49080 55.03599 53.19384 54.13614 53.92784 54.28620
## [2458] 54.25170 51.58713 52.68681 52.95715 54.82761 50.73515 54.14502
## [2465] 51.86167 51.96208 55.09584 53.85487 53.18162 50.86138 53.03464
## [2472] 52.83804 53.43826 54.98314 54.56213 53.39357 52.91125 50.43489
## [2479] 54.60190 51.96298 54.44772 55.96275 52.57822 51.14680 50.07661
## [2486] 55.42115 52.29247 53.46180 52.38931 53.71592 52.39270 54.25617
## [2493] 52.56520 54.48875 54.65829 52.56389 55.19435 53.02362 52.48933
## [2500] 53.10954 53.23271 51.23642 53.15096 53.28477 52.56562 54.40787
## [2507] 53.66265 51.45638 53.40267 54.35393 53.89744 53.95155 52.20625
## [2514] 53.89744 53.30774 54.30300 52.91302 52.07825 54.94984 50.85890
## [2521] 51.89594 53.97114 52.14923 55.81456 52.67992 52.41557 53.44134
## [2528] 53.32970 55.80458 53.89105 51.30618 51.23798 53.12007 53.20485
## [2535] 51.82100 53.12133 54.03239 53.28170 53.91610 50.60620 51.07078
## [2542] 52.91322 53.08158 51.15503 55.56832 52.07869 54.38882 54.35144
## [2549] 52.13989 53.38936 54.64060 55.10296 54.79782 51.15172 54.03239
## [2556] 53.55729 54.01394 54.46290 54.19058 53.61138 50.87567 53.01048
## [2563] 54.80702 52.01681 54.14718 52.62047 53.34880 55.24220 53.33489
## [2570] 53.29474 52.29720 53.52320 54.04755 53.40827 53.84912 53.35152
## [2577] 53.20314 52.51592 55.06061 53.17617 54.55324 53.28245 53.53147
## [2584] 54.61341 51.28658 55.88322 51.92165 53.70695 52.37449 50.79570
## [2591] 52.94554 51.93480 51.16886 52.36188 51.90653 51.85552 54.23224
## [2598] 52.72727 55.16394 51.88687 52.62831 51.97950 52.30086 53.29599
## [2605] 52.32616 51.96345 55.17680 52.93663 52.21539 52.48578 53.07743
## [2612] 52.21200 52.66247 50.92846 52.31738 52.27875 50.79631 56.48578
## [2619] 51.78489 55.15902 51.87163 53.02828 52.95872 53.59693 52.79287
## [2626] 51.87928 52.77047 55.06480 51.56821 51.80877 53.41171 50.86694
## [2633] 53.91014 53.44041 53.48502 53.59013 56.41163 54.43393 52.12579
## [2640] 52.68887 53.62106 53.74803 54.87017 54.01888 53.51999 51.05287
## [2647] 51.88725 52.83212 53.93610 54.45272 53.04111 55.11102 52.38159
## [2654] 53.74519 54.49071 52.25300 53.18605 53.30763 52.72757 54.07662
## [2661] 52.56426 52.23735 52.73198 52.24306 53.98137 53.33148 53.05976
## [2668] 54.59669 51.87778 52.11228 50.94878 53.69683 50.96143 53.88039
## [2675] 53.09319 53.24568 52.42808 52.22509 49.67242 52.83135 56.41084
## [2682] 51.59023 53.79350 56.03703 54.14870 55.10992 53.51127 53.84025
## [2689] 51.84302 50.70472 53.54808 53.02340 52.15437 55.31809 52.38378
## [2696] 50.37464 54.46693 53.22228 54.27603 51.68546 54.23529 53.19123
## [2703] 51.64445 54.77850 53.03024 52.68868 53.07113 54.52484 52.60349
## [2710] 52.16073 53.20847 52.13324 54.03772 53.92236 52.99625 51.73604
## [2717] 52.66287 52.20928 52.10745 53.19600 51.95328 51.60696 52.20535
## [2724] 54.40228 55.18838 54.27025 55.06979 54.01970 53.81034 52.39696
## [2731] 51.90061 53.81254 52.27239 53.96114 52.90437 55.13854 54.15328
## [2738] 54.31774 55.37618 51.28881 54.17924 52.84478 52.03979 53.99220
## [2745] 53.47303 52.14252 53.40855 55.72871 54.23844 52.26542 54.86417
## [2752] 51.25080 53.99525 53.87927 54.12011 54.16587 50.78978 53.53806
## [2759] 54.01459 52.24739 53.73596 53.99562 53.46406 54.28620 52.39508
## [2766] 53.42966 52.66325 52.41259 53.22076 52.27779 52.59933 52.64808
## [2773] 51.81201 51.61884 52.41674 52.33860 53.99947 54.48691 52.78248
## [2780] 55.83988 51.74483 51.77948 51.91067 52.79612 53.62734 53.06828
## [2787] 54.58916 51.96176 54.92100 52.03139 51.71159 51.95239 54.04638
## [2794] 56.17580 54.63840 54.37449 54.44772 54.61341 54.46476 54.77300
## [2801] 54.77300 55.87619 54.12138 54.05750 52.93862 52.29514 51.85446
## [2808] 50.83289 53.33353 53.11214 52.14869 53.90780 52.15445 50.90670
## [2815] 53.57232 51.52503 52.60034 54.12909 54.79489 52.84516 53.37192
## [2822] 53.65014 54.96934 55.71936 52.54514 50.60163 51.61894 54.30922
## [2829] 52.05850 53.84228 53.28170 50.67816 52.43603 51.68668 51.73736
## [2836] 53.32694 51.12048 52.62904 52.13537 53.17208 54.72356 52.57871
## [2843] 51.55988 52.75175 54.21973 52.37167 52.60568 52.90797 53.19022
## [2850] 55.68393 54.61981 52.07993 55.61896 52.24666 53.00110 54.97288
## [2857] 53.32635 54.50838 52.61489 53.44121 51.68546 54.60283 50.98508
## [2864] 50.58473 54.11440 53.25965 52.36529 54.11191 54.65641 54.63749
## [2871] 53.92052 51.64242 52.61742 52.88633 50.96830 54.29052 52.65580
## [2878] 53.24502 51.97431 53.82582 51.25143 52.35409 53.07655 52.01542
## [2885] 54.65931 53.43826 54.30315 52.40014 54.75963 53.16112 52.39181
## [2892] 53.66906 53.42060 53.04343 53.73888 51.33999 54.78787 52.70887
## [2899] 54.31740 52.40748 53.84820 53.15283 51.65550 52.06821 53.51134
## [2906] 52.41435 52.72289 51.91120 52.54299 54.01501 53.51307 53.60025
## [2913] 53.81882 52.31174 51.60873 54.29256 53.27735 51.42306 54.28156
## [2920] 52.94252 53.80271 52.62573 52.22299 51.73736 51.67532 50.80961
## [2927] 51.71471 52.26816 53.39193 53.04119 51.93795 52.05734 55.11637
## [2934] 54.26349 54.07642 51.41179 51.33944 52.95539 52.22299 53.59693
## [2941] 53.11124 52.29049 51.57511 53.75624 54.77130 53.60898 52.82260
## [2948] 53.17219 53.52204 52.01988 53.70675 53.10954 52.87112 54.71668
## [2955] 54.42851 50.89063 54.12341 54.55757 51.20381 51.87837 53.67544
## [2962] 53.43856 53.87554 52.26422 52.18606 54.50876 52.43748 54.19281
## [2969] 53.68483 52.24306 52.56194 51.77808 54.66534 52.35770 52.80718
## [2976] 53.58320 52.03760 52.84478 51.33670 52.11344 52.58081 55.27989
## [2983] 53.65225 52.02164 53.51338 56.95595 52.57134 51.23943 52.86221
## [2990] 55.51389 52.96884 52.52997 53.81728 52.59878 52.47987 52.31621
## [2997] 55.02994 54.14986 52.23735 53.34363 51.79208 52.58728 55.22950
## [3004] 50.85896 53.75065 54.73105 54.62279 52.11732 53.47234 50.24918
## [3011] 54.68747 54.47382 52.14482 53.33220 52.01369 54.38935 53.77691
## [3018] 51.28059 52.56614 54.42713 52.94413 52.60241 52.01027 52.51230
## [3025] 52.88740 52.11787 57.10981 53.36710 55.23675 53.86799 54.07602
## [3032] 53.34092 52.54350 54.25850 51.31900 54.35041 55.06929 53.43334
## [3039] 54.26559 52.21323 51.63024 52.36877 53.92817 52.93941 53.36488
## [3046] 53.98684 53.77349 53.67193 50.07555 54.24059 51.34287 52.94896
## [3053] 52.59619 54.56258 54.03233 53.67231 53.22687 52.78957 52.65358
## [3060] 52.54603 53.62701 53.46807 54.24761 51.60379 53.59713 51.85387
## [3067] 54.32698 53.22030 51.20971 53.58513 54.71136 53.08639 51.84630
## [3074] 50.19354 51.57189 50.70468 51.89748 53.11585 53.33765 54.53614
## [3081] 50.98539 53.93489 51.41582 54.91510 52.58494 54.11592 52.71897
## [3088] 52.65466 54.51902 52.70396 53.83667 53.98002 53.31969 52.43656
## [3095] 52.17320 52.79912 53.00636 51.17733 53.33444 53.76214 52.47485
## [3102] 53.65437 52.81001 53.56246 51.94153 50.76374 51.75385 55.64668
## [3109] 52.06084 52.61665 50.95666 54.01809 51.54199 54.51769 51.84061
## [3116] 53.29071 53.05025 52.53061 55.12477 54.01085 53.25114 53.05207
## [3123] 54.38524 52.23750 53.29130 53.85693 52.73958 50.54480 53.25951
## [3130] 52.10766 53.86755 51.82928 54.26507 53.29755 51.79248 52.39240
## [3137] 51.89136 53.14384 53.05709 53.23191 50.44983 53.21656 51.64611
## [3144] 50.98168 53.21271 52.03123 53.42558 51.62358 50.34277 52.91615
## [3151] 54.61577 51.13436 52.88680 52.04544 53.20608 50.93538 53.08274
## [3158] 55.38728 53.29974 51.13318 52.31922 51.54988 52.16474 54.09092
## [3165] 53.08631 52.19145 54.80711 53.39447 50.08710 51.27302 52.87141
## [3172] 51.62753 54.72431 53.36584 51.87852 52.81001 49.65669 52.09155
## [3179] 53.02246 51.44125 51.93752 52.72449 52.35187 50.95730 53.53997
## [3186] 53.83382 52.60687 53.50389 52.40122 53.05759 52.91277 54.57925
## [3193] 51.05512 53.82636 52.88299 52.17702 54.52509 52.92225 52.08031
## [3200] 53.03148 50.74248 54.60561 53.59148 52.40548 51.70687 50.74937
## [3207] 52.07210 52.86432 50.31823 52.95071 53.31026 53.53556 53.08274
## [3214] 54.03233 51.21886 50.79092 54.02620 52.89713 51.90623 54.21813
## [3221] 52.80308 52.82526 52.27983 52.50677 53.12252 53.97512 53.30912
## [3228] 53.45105 53.53412 55.80391 54.16892 54.15311 53.04389 54.28193
## [3235] 54.41859 53.25302 53.14066 51.27552 53.00557 53.80632 51.26137
## [3242] 55.80478 50.71711 53.45905 54.05316 52.86177 51.03196 54.72699
## [3249] 52.87720 53.75307 55.04770 53.40848 52.09187 54.49894 52.70099
## [3256] 53.11712 52.48306 53.10649 54.81360 54.15900 55.83222 52.38191
## [3263] 55.23959 52.46433 53.07310 50.93214 56.25507 54.36207 50.78679
## [3270] 55.11586 52.36694 50.18797 53.95742 56.16624 52.69173 53.39395
## [3277] 53.18712 55.09662 51.69638 53.72604 52.85095 53.33082 52.65056
## [3284] 53.29246 53.33098 54.65587 52.19095 50.17533 53.15721 52.93831
## [3291] 52.08850 54.49546 53.37970 53.18685 53.17317 50.73447 53.39045
## [3298] 56.31274 53.54166 54.06044 51.94423 55.17106 53.92123 52.54291
## [3305] 53.85279 52.23975 51.58699 54.41741 54.33180 52.88764 51.05641
## [3312] 54.52735 54.71434 51.22711 51.89169 52.08684 54.08961 54.54431
## [3319] 52.25698 51.98267 51.85730 53.85824 51.69346 52.79634 55.21181
## [3326] 52.71234 52.04436 53.42420 51.72373 52.21465 53.42233 55.44792
## [3333] 53.49875 53.17035 52.72832 52.69303 51.79007 56.02279 52.67401
## [3340] 54.17105 52.94158 54.76068 54.65278 52.70413 52.08413 55.12958
## [3347] 54.70794 54.80134 51.57255 55.02170 53.53872 53.59030 52.95268
## [3354] 52.28156 50.41786 51.27967 54.67038 54.85409 51.75876 52.71697
## [3361] 54.61007 51.81781 54.01387 52.35455 52.57666 52.92763 53.19765
## [3368] 51.89932 52.50003 50.27449 53.72278 54.28536 56.06314 53.83709
## [3375] 56.16024 54.68514 54.03654 52.09982 52.04211 51.27617 52.46987
## [3382] 50.80629 53.54214 54.26844 55.09984 53.94704 55.58599 52.50500
## [3389] 52.68384 51.50939 53.25959 49.36387 54.10007 51.78189 51.52942
## [3396] 54.48145 51.32148 52.24425 53.45470 52.37668 53.01202 51.03747
## [3403] 52.62277 51.83816 56.06564 54.43061 55.38256 51.23506 51.87918
## [3410] 54.40122 53.85846 51.93573 51.52012 53.69628 54.53050 52.07585
## [3417] 52.03097 52.77851 54.14698 53.11291 54.51038 48.65735 55.55227
## [3424] 50.65899 55.91418 52.84390 51.42091 50.64770 52.92969 55.24450
## [3431] 54.17598 51.61113 52.85489 52.34434 51.98062 52.94559 54.36598
## [3438] 52.13327 52.65242 54.58544 50.39367 49.77236 53.15326 53.25308
## [3445] 50.59101 53.93271 51.94604 52.05720 54.43175 55.20961 53.99167
## [3452] 50.32545 54.12807 52.07255 54.34900 54.07744 53.62144 54.14228
## [3459] 52.05451 54.34699 54.90350 52.87913 49.70417 53.71540 54.48942
## [3466] 52.22466 53.86866 52.42118 52.67053 53.13501 53.75629 52.05261
## [3473] 54.42491 53.37821 54.52965 54.52412 53.37302 52.92116 55.02285
## [3480] 55.88996 54.23427 52.81700 52.12583 52.67403 52.35488 52.05620
## [3487] 52.69543 54.39412 52.92184 51.17923 54.21619 52.89075 55.33059
## [3494] 52.92928 54.20955 51.78984 53.60896 52.21555 54.34699 53.90339
## [3501] 53.94283 53.68169 51.77000 53.26331 55.68059 53.18102 52.44694
## [3508] 54.25348 55.04866 55.54116 49.97712 53.21419 53.91549 53.43778
## [3515] 53.12943 54.47462 52.67203 53.30912 54.27303 54.01672 54.57560
## [3522] 50.83720 54.59621 52.20077 52.04983 51.86056 51.72630 50.49117
## [3529] 52.24056 49.36133 52.36125 53.43283 52.56588 53.66824 52.22698
## [3536] 53.07453 53.92066 50.91460 52.76869 49.77702 52.57616 53.94639
## [3543] 53.52427 52.94031 52.90721 53.36543 53.09744 52.66874 53.36137
## [3550] 54.00769 53.71976 52.43119 53.89587 52.06487 54.21824 52.92570
## [3557] 54.24229 53.79706 53.29688 53.88296 54.44033 49.24528 52.76641
## [3564] 53.09927 51.40404 53.27670 50.89196 53.24510 53.22030 53.92454
## [3571] 53.00787 53.22162 54.07313 52.24366 53.87550 53.57636 53.55837
## [3578] 54.63845 52.05139 53.80884 54.17551 53.76296 52.83052 52.63127
## [3585] 50.99531 53.84286 54.48243 52.48562 52.27850 52.73885 50.00576
## [3592] 55.06747 55.18966 52.70508 50.10329 54.97610 52.63327 52.28923
## [3599] 53.54206 53.28322 53.30024 52.75399 52.88045 54.07240 51.63024
## [3606] 50.46944 51.91144 53.38569 53.55298 55.82550 53.42111 51.53284
## [3613] 52.22276 51.40765 54.93053 53.78807 51.14524 52.19887 53.83760
## [3620] 54.33361 51.35183 52.24200 51.76599 52.53699 52.28841 53.64186
## [3627] 52.85489 53.83975 52.72270 53.07753 54.27939 49.77702 55.74502
## [3634] 53.69462 54.39330 52.96587 53.64407 54.71317 53.89174 51.88662
## [3641] 55.85030 52.65353 53.43494 53.85242 53.51739 55.42118 51.79769
## [3648] 52.67442 52.94413 52.29852 54.97767 52.60717 52.64009 52.13422
## [3655] 55.90972 52.47180 55.43200 51.54682 53.50491 52.28004 53.12815
## [3662] 53.80814 53.73811 51.83774 53.09960 52.42322 51.96354 52.62717
## [3669] 52.51034 53.63317 54.11960 55.85760 51.17453 53.99285 51.99530
## [3676] 55.85353 52.12031 51.64008 54.01548 53.50086 54.55623 54.16055
## [3683] 53.56413 53.08891 52.88473 53.36453 54.19592 54.96740 53.48924
## [3690] 53.37593 55.78659 52.17702 53.53072 52.57088 52.07240 52.09457
## [3697] 56.19395 54.45473 51.24039 53.25233 51.29474 53.56707 54.03453
## [3704] 53.20737 54.15555 56.12591 48.63836 53.88858 51.84512 53.03148
## [3711] 53.01921 53.05709 52.12422 51.73512 53.21397 52.14750 54.15719
## [3718] 52.09309 55.73717 52.15572 52.88503 53.52545 51.79758 52.76556
## [3725] 53.59184 53.92568 53.22187 52.15245 53.92028 53.81943 53.44716
## [3732] 52.62061 53.51373 52.70082 54.66398 52.87675 52.43194 53.29726
## [3739] 53.14015 52.95281 54.92821 54.61392 52.11377 52.68649 51.63988
## [3746] 55.39970 53.00588 55.27246 50.94635 53.81372 51.99753 53.95878
## [3753] 53.45892 53.07057 52.40593 53.99755 52.50120 53.56419 53.75570
## [3760] 51.48812 53.25126 51.23978 54.52994 53.72667 54.62808 53.86978
## [3767] 52.99172 53.62201 53.15005 52.78464 50.40183 51.80145 52.87158
## [3774] 52.37144 51.83972 52.77389 54.20392 53.89597 48.65735 52.81940
## [3781] 51.85068 53.03717 51.26517 53.16916 54.14401 52.62074 50.80629
## [3788] 54.94066 54.15209 52.06776 53.42420 53.44675 51.57836 54.08109
## [3795] 53.93548 53.22164 52.25066 54.45751 54.04258 52.09827 54.78899
## [3802] 51.76034 53.79543 53.72620 52.66028 53.41072 52.22969 53.67050
## [3809] 53.63213 53.38787 52.20137 53.21419 51.48209 53.11572 53.05394
## [3816] 53.89709 54.27650 53.56403 53.26114 55.04670 55.35151 53.33873
## [3823] 53.08958 52.39283 52.34003 53.39203 53.10816 51.30927 52.34097
## [3830] 51.01907 53.23191 50.91208 51.85496 55.17870 52.02359 53.66902
## [3837] 52.91652 53.56377 51.67437 51.23147 50.28598 51.85235 53.52906
## [3844] 51.30133 53.05176 52.87377 53.01760 52.64299 54.84435 53.36078
## [3851] 55.69497 54.44167 52.35151 52.89481 52.77909 55.60880 54.49546
## [3858] 51.74155 53.42844 53.08713 53.95742 53.30599 53.30063 54.04239
## [3865] 53.52754 52.61888 53.24891 51.10792 53.16578 53.15888 53.17876
## [3872] 54.19266 55.32792 53.37305 54.03351 50.75984 52.48616 51.82299
## [3879] 54.80824 52.39883 54.17980 53.27864 53.02175 54.31096 52.87560
## [3886] 52.75963 53.46254 52.83327 53.28485 51.77401 53.09938 54.01069
## [3893] 55.12086 52.42354 54.10513 53.29547 50.49897 54.28570 54.47382
## [3900] 52.82547 50.32593 54.45099 54.16703 52.29097 54.44973 53.22778
## [3907] 53.56361 52.64365 52.10406 53.98564 54.11283 53.18712 54.51225
## [3914] 52.75989 49.68598 53.11952 52.75154 53.40829 54.69483 51.51384
## [3921] 52.35196 52.93528 52.76221 52.78923 54.13264 52.66660 52.84193
## [3928] 53.62340 52.92570 53.44380 54.20507 53.92854 55.04599 51.79008
## [3935] 53.39503 54.09910 51.98618 52.66972 52.79122 53.28852 52.34710
## [3942] 51.16529 52.42814 53.41745 54.74983 51.54021 53.50765 55.98876
## [3949] 55.10246 51.33771 53.19578 53.35862 51.48423 52.17024 51.56726
## [3956] 52.79161 54.31896 53.75684 50.64968 53.44406 55.29692 51.18203
## [3963] 52.86052 51.33771 52.36029 53.75019 54.36328 53.11003 52.84878
## [3970] 56.22898 51.43960 54.05197 54.17189 53.66503 52.59507 53.05025
## [3977] 53.32226 53.51863 53.33444 55.23236 52.61916 52.34453 51.86919
## [3984] 51.92258 52.62477 56.18355 52.57563 54.36426 52.77513 52.85111
## [3991] 54.36238 55.80221 50.03319 51.97138 52.81032 53.74697 53.18841
## [3998] 54.50707 52.58901 53.12359</code></pre>
</div>
<div class="section level3">
<h3>取り出したデータセットを見てみる</h3>
<pre class="r"><code>rstan::extract(fit,pars=&quot;mu&quot;) %&gt;% data.frame() %&gt;% summary()</code></pre>
<pre><code>##        mu       
##  Min.   :48.64  
##  1st Qu.:52.25  
##  Median :53.12  
##  Mean   :53.11  
##  3rd Qu.:53.98  
##  Max.   :57.74</code></pre>
</div>
<div class="section level3">
<h3>取り出したデータセットを使って</h3>
<pre class="r"><code>rstan::extract(fit,pars=&quot;mu&quot;) %&gt;% data.frame() -&gt;result.df
# データ数
NROW(result.df)</code></pre>
<pre><code>## [1] 4000</code></pre>
<pre class="r"><code># 任意のパーセンタイル点
quantile(result.df$mu,probs = c(0.025,0.56,0.98))</code></pre>
<pre><code>##     2.5%      56%      98% 
## 50.61918 53.29570 55.80127</code></pre>
<pre class="r"><code># 任意の区間の密度
NROW(result.df[result.df$mu&gt;55 &amp; result.df$mu &lt; 60,])/NROW(result.df)</code></pre>
<pre><code>## [1] 0.0685</code></pre>
<pre class="r"><code># 別解
result.df %&gt;% dplyr::filter(.$mu&gt;55 &amp; .$mu&lt;60) %&gt;% NROW(.)/4000</code></pre>
<pre><code>## [1] 0.0685</code></pre>
</div>
</div>
<div id="mcmc" class="section level1">
<h1>MCMCの様々な特徴</h1>
<div id="mcmc" class="section level3">
<h3>MCMCサンプルの数が増えると?</h3>
<pre class="r"><code>## 5000サンプル
fit5000 &lt;- sampling(model1,dataset,warmup=2500,iter=5000,chains=4,thin=2)
## 10000サンプル
fit10000 &lt;- sampling(model1,dataset,warmup=2500,iter=7500,chains=4,thin=2)
##
print(fit5000)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya.
## 4 chains, each with iter=5000; warmup=2500; thin=2; 
## post-warmup draws per chain=1250, total post-warmup draws=5000.
## 
##        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
## mu    53.14    0.02 1.29  50.68  52.24  53.15  54.03  55.64  3131    1
## lp__ -19.55    0.01 0.71 -21.49 -19.72 -19.28 -19.09 -19.04  3575    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:26 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<pre class="r"><code>print(fit10000)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya.
## 4 chains, each with iter=7500; warmup=2500; thin=2; 
## post-warmup draws per chain=2500, total post-warmup draws=10000.
## 
##        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
## mu    53.07    0.02 1.29  50.54  52.20  53.08  53.93  55.58  6440    1
## lp__ -19.54    0.01 0.70 -21.52 -19.71 -19.27 -19.09 -19.04  7194    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:28 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
</div>
<div class="section level3">
<h3>データ数が増えると?</h3>
<pre class="r"><code>Y1 &lt;- round(rnorm(10, 53, 9))
Y2 &lt;- round(rnorm(100,53, 9))
#
dataset1 &lt;- list(N=10,X=Y1)
dataset2 &lt;- list(N=100,X=Y2)
#
mcmc1 &lt;- sampling(model1,dataset1)
mcmc2 &lt;- sampling(model1,dataset2)
#
print(mcmc1)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##       mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
## mu   52.02    0.07 2.82 46.55 50.14 52.00 53.87 57.43  1540    1
## lp__ -5.58    0.02 0.71 -7.49 -5.75 -5.31 -5.14 -5.09  1928    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:31 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<pre class="r"><code>print(mcmc2)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
## mu    53.63    0.02 0.90  51.91  53.00  53.63  54.24  55.39  1444    1
## lp__ -45.19    0.02 0.69 -47.17 -45.34 -44.92 -44.75 -44.69  1862    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:33 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
</div>
<div class="section level2">
<h2>事前分布を活かす</h2>
<pre class="r"><code># データセット全体
Y_all &lt;- round(rnorm(30,53,9)) %&gt;% print</code></pre>
<pre><code>##  [1] 51 51 67 52 65 47 48 48 65 48 46 52 55 52 61 45 36 62 51 46 63 61 56
## [24] 46 41 54 51 51 57 50</code></pre>
<pre class="r"><code># データセットを半分こ
Y_pre &lt;- Y_all[1:15] %&gt;% print</code></pre>
<pre><code>##  [1] 51 51 67 52 65 47 48 48 65 48 46 52 55 52 61</code></pre>
<pre class="r"><code>Y_post &lt;- Y_all[16:30] %&gt;% print</code></pre>
<pre><code>##  [1] 45 36 62 51 46 63 61 56 46 41 54 51 51 57 50</code></pre>
<pre class="r"><code>model2 &lt;- stan_model(&quot;yoshinaya2.stan&quot;)</code></pre>
<pre><code>## data{
##   int&lt;lower=1&gt; N;
##   real X[N];
##   real pre_mu;
##   real pre_sig;
## }
## 
## parameters{
##   real mu;
## }
## 
## model{
##   X ~ normal(mu,9);
##   mu ~ normal(pre_mu,pre_sig);
## }</code></pre>
<pre class="r"><code># 全データを使って
dataAll &lt;- list(N=30,X=Y_all,pre_mu=0,pre_sig=100)
fit_all &lt;- sampling(model2,dataAll)
fit_all</code></pre>
<pre><code>## Inference for Stan model: yoshinaya2.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
## mu    52.57    0.04 1.63  49.41  51.48  52.55  53.62  55.68  1585    1
## lp__ -10.54    0.02 0.73 -12.58 -10.71 -10.26 -10.10 -10.05  1883    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:35 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<pre class="r"><code># 前半分
data_pre &lt;- list(N=15,X=Y_pre,pre_mu=0,pre_sig=100)
fit_pre &lt;- sampling(model2,data_pre)
# 無情報後ろ半分
data_post &lt;- list(N=15,X=Y_post,pre_mu=0,pre_sig=100)
fit_withNoPrior &lt;- sampling(model1,data_post)

# 事前分布の情報を前半分データから取り出す
rstan::extract(fit_pre,pars=&quot;mu&quot;) %&gt;% data.frame %&gt;% 
  gather(key,val) %&gt;% summarize(pre_mu=mean(val),pre_sig=sd(val)) -&gt; Prior_val
# 事前分布の情報を追記
data_post2 &lt;- list(N=15,X=Y_post,pre_mu=Prior_val$pre_mu,pre_sig=Prior_val$pre_sig)
fit_withPrior &lt;- sampling(model2,data_post2)

print(fit_pre)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya2.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##       mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
## mu   53.72    0.06 2.34 49.16 52.15 53.69 55.33 58.29  1497    1
## lp__ -5.05    0.02 0.72 -7.05 -5.21 -4.77 -4.59 -4.54  1682    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:37 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<pre class="r"><code>print(fit_withNoPrior)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##       mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
## mu   51.35    0.06 2.34 46.68 49.77 51.40 52.91 55.85  1632    1
## lp__ -5.73    0.02 0.73 -7.63 -5.89 -5.45 -5.27 -5.22  1642    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:39 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<pre class="r"><code>print(fit_withPrior)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya2.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##      mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
## mu   52.5    0.04 1.68 49.29 51.39 52.47 53.64 55.76  1531    1
## lp__ -6.0    0.02 0.73 -8.10 -6.19 -5.71 -5.53 -5.48  2177    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:42 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<pre class="r"><code>print(fit_all)</code></pre>
<pre><code>## Inference for Stan model: yoshinaya2.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
## mu    52.57    0.04 1.63  49.41  51.48  52.55  53.62  55.68  1585    1
## lp__ -10.54    0.02 0.73 -12.58 -10.71 -10.26 -10.10 -10.05  1883    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:35 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
</div>
</div>
<div class="section level1">
<h1>事後予測分布を描こう</h1>
<p>モデルのチェックにも使える事後予測分布を描く練習です。</p>
<pre class="r"><code>N &lt;- 50
Z &lt;- rnorm(N,0,1)
model_norm &lt;- stan_model(&quot;normal_PPD.stan&quot;)</code></pre>
<pre><code>## data{
##   int&lt;lower=0&gt; N;
##   real X[N];
## }
## 
## parameters{
##   real mu;
##   real&lt;lower=0&gt; sig;
## }
## 
## model{
##   // likelihood
##   X ~ normal(mu,sig);
##   //prior
##   mu ~ normal(0,100);
##   sig ~ cauchy(0,5);
## }
## 
## generated quantities{
##   real pred;
##   pred = normal_rng(mu,sig);
## }</code></pre>
<pre class="r"><code>fit.norm &lt;- sampling(model_norm,data=list(N=N,X=Z))
print(fit.norm)</code></pre>
<pre><code>## Inference for Stan model: normal_PPD.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
## mu     0.01    0.00 0.15  -0.29  -0.10   0.01   0.11   0.32  2421    1
## sig    1.08    0.00 0.11   0.89   1.01   1.08   1.15   1.33  2820    1
## pred  -0.01    0.02 1.10  -2.18  -0.74   0.01   0.72   2.15  3532    1
## lp__ -28.21    0.03 1.01 -30.92 -28.63 -27.88 -27.47 -27.21  1606    1
## 
## Samples were drawn using NUTS(diag_e) at Sun Aug 26 10:33:44 2018.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<div class="section level4">
<h4>データの分布</h4>
<pre class="r"><code>ggplot(data.frame(val=Z),aes(x=val))+geom_histogram(binwidth = 0.1)</code></pre>
<p><img src="jssp02_files/figure-html/data_dist-1.png" width="672" /></p>
</div>
<div class="section level4">
<h4>事後予測分布</h4>
<pre class="r"><code>rstan::extract(fit.norm,pars=&quot;pred&quot;) %&gt;% data.frame %&gt;% 
  ggplot(aes(x=pred))+geom_histogram(binwidth = 0.1)</code></pre>
<p><img src="jssp02_files/figure-html/PPD-1.png" width="672" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
